# XDoG Sketch

Fast artistic rendering of photos in the browser with XDoG, React & [deeplearn.js](https://deeplearnjs.org). The app recreates XDoG image stylization technique as described in the Winnemoller et. al's papers *XDoG: Advanced Image Stylization with eXtended Difference-of-Gaussians* (DOI: [10.1145/2024676.2024700](https://doi.org/10.1145/2024676.2024700)) and *XDoG: An eXtended difference-of-Gaussians compendium including advanced image stylization* (DOI: [10.1016/j.cag.2012.03.004](https://doi.org/10.1016/j.cag.2012.03.004)). The deeplearn.js library is used to perform fast, GPU-accelerated image processing in the browser.

## Usage/Installation

By far the easiest way to run & experiment with the app is to access the live version at:

https://xdog.alexpeattie.com

Alternatively, the app can be built and run locally.

#### Node.js

The first prerequisite is a recent version of Node.js (>= v. 8). Steps for installing Node will vary depending on environment/OS. Node 8 can be installed on a Ubuntu environment (e.g. the Course VM) by running:

```
curl -sL https://deb.nodesource.com/setup_8.x | sudo -E bash -
sudo apt-get install -y nodejs
```

Instructions for other OSes can be found at: <https://nodejs.org/en/download/package-manager/>.

#### Yarn

Next we'll need to install Yarn; for simplicity I suggest using NPM:

```
npm install -g yarn
```

Next, install the dependencies by running (in the same directory as `package.json`):

```
yarn install
```

#### Running the dev server

Now you should be able to run:

```
npm run start
```

The server will be accessible at http://localhost:3067/. Note, if you're running the server inside of the VM, you'll need to modify you're `Vagrantfile` and either setup port forwarding:

```
config.vm.network :forwarded_port, guest: 3067, host: 3067
```

Or assign your VM an IP address:

```
config.vm.network :private_network, ip: "192.168.68.99"
```

And access the development server via 192.168.68.99:3067.

#### Building the app

Alternatively, you can compile the app, to be run with a static server. Run:

```
npm run build
```

When the build is completed, all the compiled files will be in the `build/` directory, and can be served by any static file server. One option is [serve](https://github.com/zeit/serve):

```
npm install -g serve
serve -s build
```

## Dependencies

This project was greatly helped by the following 3rd-party libraries:

- basename - for filename processing
- classnames - for conditionally toggling CSS classes
- deeplearn.js - for fast, GPU-accelerated computation
- detect-browser - to show warnings for outdated browsers
- gaussian-convolution-kernel - to create a Gaussian kernel for a given window size and sigma
- get-pixels - to convert pixels in an image to an NDArray
- ndarray - an efficient data structure for storing numerical data (image pixels in this case)
- numeral - for number formatting for the parameter sliders
- promise-file-reader - for reading uploaded files
- react & react-dom - to power the UI
- react-dropzone - to facilitate drag & drop uploads
- react-redux, redux, redux-thunk & redux-form - for front-end state management
- save-pixels - to write the resulting pixel NDArray to an image stream
- spectre.css - a CSS library used to style the app
- stream-to-promise - to write the image stream generated by save-pixels to a buffer
- styled-components - to ease the styling of React components